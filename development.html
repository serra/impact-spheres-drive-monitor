
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Development &#8212; Impact Spheres Scripts 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Deployment" href="deployment.html" />
    <link rel="prev" title="Functionality" href="functionality.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="development">
<span id="id1"></span><h1>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h1>
<p>This repository contains our Python Scripts.
This document will help you to get started if you want to contribute to those.</p>
<p>We also have a Google Docs Add-On that is maintained outside this repository.
It is available in the Impact Spheres guides folder.
Impact Spheres contributors can access <a class="reference external" href="https://docs.google.com/document/d/1ISqiBCOewgPYycaId4vUCFuARObpr5eg9XNWb0_oCVQ/edit">the script here</a></p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>The Scripts target Python 3.
Developed on OSX, Python version 3.6.</p>
<div class="section" id="virtualenv">
<h3>Virtualenv<a class="headerlink" href="#virtualenv" title="Permalink to this headline">¶</a></h3>
<p>It is recommended that you develop in <a class="reference external" href="http://docs.python-guide.org/en/latest/dev/virtualenvs/#lower-level-virtualenv">a virtual environment</a>.</p>
<p>I set up mine like this (assuming virtualenv 1.7+):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="p">[</span><span class="n">impact</span><span class="o">-</span><span class="n">spheres</span><span class="o">-</span><span class="n">drive</span><span class="o">-</span><span class="n">monitor</span><span class="p">]</span>
<span class="n">virtualenv</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span> <span class="n">venv</span>
<span class="n">source</span> <span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
</div>
<div class="section" id="bootstrap-your-environment">
<h3>Bootstrap your environment<a class="headerlink" href="#bootstrap-your-environment" title="Permalink to this headline">¶</a></h3>
<p>After setting up your environment, from a terminal, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">bootstrap</span>
</pre></div>
</div>
<p>This should install all dependencies. At this stage:</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
<span class="n">The</span> <span class="n">development</span> <span class="n">environment</span> <span class="ow">is</span> <span class="n">bootstrapped</span>
    <span class="n">File</span> <span class="n">should</span> <span class="n">exist</span>    <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
    <span class="n">All</span> <span class="n">dependencies</span> <span class="n">should</span> <span class="n">be</span> <span class="n">installed</span>
</pre></div>
</div>
<p>We have got some work left to do,
but now you can already verify whether your environment
is properly setup for development:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">check</span><span class="o">-</span><span class="n">environment</span>
</pre></div>
</div>
<p>When running this the first time, you will see many failing tests.
In the remainder of this document
we’ll setup your environment so that you can hack away.</p>
<p>Don’t worry, it shouldn’t take long.</p>
</div>
</div>
<div class="section" id="run-tests">
<h2>Run tests<a class="headerlink" href="#run-tests" title="Permalink to this headline">¶</a></h2>
<p>You should be able to run the tests now. Try:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">test</span>
</pre></div>
</div>
<p>This runs the unit tests in the <cite>tests</cite> directory.</p>
</div>
<div class="section" id="access-google-drive">
<h2>Access Google Drive<a class="headerlink" href="#access-google-drive" title="Permalink to this headline">¶</a></h2>
<p>The directory <cite>google</cite> contains scripts
for inspecting our content on Google Drive.</p>
<p>To use these scripts you’ll need a Google account.
To access drive files, you need a Google API key.
You can configure access using the <a class="reference external" href="https://console.developers.google.com/apis/credentials?project=ageless-aquifer-176113">Google API management console</a>.</p>
<p>To access the private drive files in our <a class="reference external" href="https://drive.google.com/drive/u/0/folders/0B9xuqHFCF4WMMUN5bENtaFEtSmM">Impact Spheres directory</a>,
an authorized human being has to give consent.
This consent can be given <a class="reference external" href="https://developers.google.com/drive/v3/web/quickstart/python">using OAuth2</a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Giving consent gives the script access to ALL your data on Google Drive,
From the moment you give consent, the script can impersonate you
as long as the client ID is active.
Consider using a dedicated Google account instead of your personal account.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do NOT share your OAuth client secret.</p>
</div>
<p>API keys as well as client IDs can be managed in your personal
<a class="reference external" href="https://console.developers.google.com/apis/credentials?project=ageless-aquifer-176113">Google API management console</a>.</p>
<p>If you have setup your API key and client id,
then save your client id and secret as
<cite>drive_client_secret.json</cite> in the root folder.</p>
<p>To setup your Google credentials, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">auth</span><span class="o">-</span><span class="n">google</span>
</pre></div>
</div>
<p>This will open a browser to login to a Google account
and to give consent to access data.</p>
<p>Add your Google API key to your environment variables.
Add your client id and secret to your environment as well.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I strongly recommend using a tool like <a class="reference external" href="https://direnv.net/">direnv</a>
to manage your environment variables.</p>
</div>
<p>At this stage:</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
<span class="n">Google</span> <span class="n">client</span> <span class="nb">id</span> <span class="ow">and</span> <span class="n">secret</span> <span class="n">should</span> <span class="n">be</span> <span class="n">saved</span> <span class="n">on</span> <span class="n">disk</span>
    <span class="n">File</span> <span class="n">should</span> <span class="n">exist</span>   <span class="n">drive_client_secret</span><span class="o">.</span><span class="n">json</span>

<span class="n">Google</span> <span class="n">environment</span> <span class="n">variables</span> <span class="n">should</span> <span class="n">be</span> <span class="nb">set</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">GOOGLE_API_KEY</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">GOOGLE_CREDENTIALS</span>

<span class="n">The</span> <span class="n">scripts</span> <span class="n">can</span> <span class="n">access</span> <span class="n">Impact</span> <span class="n">Spheres</span> <span class="n">data</span> <span class="n">on</span> <span class="n">Google</span> <span class="n">Drive</span>
    <span class="n">Can</span> <span class="n">access</span> <span class="n">review</span> <span class="n">folder</span>
</pre></div>
</div>
</div>
<div class="section" id="access-slack">
<h2>Access Slack<a class="headerlink" href="#access-slack" title="Permalink to this headline">¶</a></h2>
<p>The directory <cite>slack</cite> contains scripts
for interaction wit Slack.</p>
<p>Slack uses OAuth2 as well.
The <a class="reference external" href="https://api.slack.com/docs/sign-in-with-slack">Slack sign-in process</a> is documented well and worth a quick read.</p>
<p>Slack integration is provided by the <a class="reference external" href="https://agilityscales.slack.com/apps/A7RHUFQ90-impact-spheres-app">Impact Spheres App</a>
on <a class="reference external" href="https://agilityscales.slack.com/">Agilityscales.slack.com</a> .</p>
<p>The client ID, client secret and verification token are managed on the
<a class="reference external" href="https://api.slack.com/apps/A7RHUFQ90">Impact Spheres App management page</a>.
<a class="reference external" href="https://agilityscales.slack.com/team/U5S1Q0YQ5">Marijn</a>, <a class="reference external" href="https://agilityscales.slack.com/team/U3MDKTU84">Jurgen</a> and <a class="reference external" href="https://agilityscales.slack.com/team/U46M319FF">Thomas</a> have management access to this app.
You might want ask one of them to add you as a collaborator.</p>
<p>Now set the client ID and secret in your environment variables,
as well as the <cite>SLACK_BOT_SCOPE</cite> environment variable:</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
<span class="n">The</span> <span class="n">environment</span> <span class="ow">is</span> <span class="n">ready</span> <span class="k">for</span> <span class="n">authenticating</span> <span class="k">with</span> <span class="n">Slack</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">SLACK_CLIENT_ID</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">SLACK_CLIENT_SECRET</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">SLACK_BOT_SCOPE</span>
    <span class="n">Should</span> <span class="n">be</span> <span class="n">equal</span>   <span class="o">%</span><span class="p">{</span><span class="n">SLACK_BOT_SCOPE</span><span class="p">}</span>  <span class="n">chat</span><span class="p">:</span><span class="n">write</span><span class="p">:</span><span class="n">bot</span>
</pre></div>
</div>
<p>You can authorize your script for local development:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">auth</span><span class="o">-</span><span class="n">slack</span>
</pre></div>
</div>
<p>Open a browser at <a class="reference external" href="http://localhost:5000/begin_auth">http://localhost:5000/begin_auth</a>.
Follow the link to start an oauth flow.
A token will be created on your behalf.
Store this token in your environment variables.
At this stage:</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
<span class="n">The</span> <span class="n">scripts</span> <span class="n">can</span> <span class="n">post</span> <span class="n">to</span> <span class="n">Slack</span> <span class="n">on</span> <span class="n">your</span> <span class="n">behalf</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">SLACK_BOT_TOKEN</span>
    <span class="n">Send</span> <span class="n">Marijn</span> <span class="n">a</span> <span class="n">direct</span> <span class="n">message</span>
</pre></div>
</div>
</div>
<div class="section" id="access-contentful">
<h2>Access Contentful<a class="headerlink" href="#access-contentful" title="Permalink to this headline">¶</a></h2>
<p>The directory <cite>content</cite> contains scripts
for accessing content on the Mind Settlers Contentful database.</p>
<p>Guides are stored in a Contentful document store.
It has an API that uses OAuth2 for authentication.
This application was created by follwing the section
“Creating an OAuth 2.0 application” in <a class="reference external" href="https://www.contentful.com/developers/docs/references/authentication/">Contentful docs on authentication</a>.</p>
<p>Client id and secret are managed from Marijn’s Contentful account.</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
<span class="n">The</span> <span class="n">environment</span> <span class="ow">is</span> <span class="n">ready</span> <span class="k">for</span> <span class="n">authenticating</span> <span class="k">with</span> <span class="n">Contentful</span><span class="p">:</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">CONTENTFUL_CLIENT_ID</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">CONTENTFUL_CLIENT_SECRET</span>
</pre></div>
</div>
<p>You can authorize your script for local development:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">auth</span><span class="o">-</span><span class="n">contentful</span>
</pre></div>
</div>
<p>Open a browser at <a class="reference external" href="http://localhost:5000/begin_auth">http://localhost:5000/begin_auth</a>.
Follow the link to start an oauth flow.
A token will be created on your behalf.
Store this token in your environment variables.</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
<span class="n">The</span> <span class="n">scripts</span> <span class="n">can</span> <span class="n">query</span> <span class="n">contentful</span> <span class="n">on</span> <span class="n">your</span> <span class="n">behalf</span>
    <span class="n">Environment</span> <span class="n">Variable</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Set</span>    <span class="n">CONTENTFUL_TOKEN</span>
    <span class="n">Search</span> <span class="k">for</span> <span class="n">guides</span>                     <span class="n">big</span> <span class="n">wall</span>
</pre></div>
</div>
</div>
<div class="section" id="run-the-webapp-locally">
<h2>Run the webapp locally<a class="headerlink" href="#run-the-webapp-locally" title="Permalink to this headline">¶</a></h2>
<p>In debug mode:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">server</span>
</pre></div>
</div>
<p>In heroku local mode:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">heroku</span><span class="o">-</span><span class="n">local</span>
</pre></div>
</div>
<p>The app is available at <a class="reference external" href="http://localhost:5000">http://localhost:5000</a>.</p>
</div>
<div class="section" id="about-this-guide">
<h2>About this guide<a class="headerlink" href="#about-this-guide" title="Permalink to this headline">¶</a></h2>
<p>This document is an executable specification.
To execute the test case in this document, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">check</span><span class="o">-</span><span class="n">environment</span>
</pre></div>
</div>
<p>The following Robotframework settings are used:</p>
<div class="code robotframework highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Settings</span> <span class="o">***</span>
<span class="n">Library</span>          <span class="n">OperatingSystem</span>
<span class="n">Library</span>          <span class="o">./</span><span class="n">lib</span><span class="o">/</span><span class="n">DevLibrary</span><span class="o">.</span><span class="n">py</span>
<span class="n">Library</span>          <span class="o">./</span><span class="n">lib</span><span class="o">/</span><span class="n">GoogleLibrary</span><span class="o">.</span><span class="n">py</span>
<span class="n">Library</span>          <span class="o">./</span><span class="n">lib</span><span class="o">/</span><span class="n">SlackLibrary</span><span class="o">.</span><span class="n">py</span>
<span class="n">Library</span>          <span class="o">./</span><span class="n">lib</span><span class="o">/</span><span class="n">ContentfulLibrary</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="functionality.html" title="previous chapter">Functionality</a></li>
      <li>Next: <a href="deployment.html" title="next chapter">Deployment</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="functionality.html">Functionality</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-tests">Run tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#access-google-drive">Access Google Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="#access-slack">Access Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="#access-contentful">Access Contentful</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-webapp-locally">Run the webapp locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="#about-this-guide">About this guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Marijn van der Zee.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/development.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/serra/impact-spheres-drive-monitor" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>